From cb2bc2dcd9fdebb871938b311156527b3330c285 Mon Sep 17 00:00:00 2001
From: "L. E. Segovia" <amy@amyspark.me>
Date: Thu, 17 Nov 2022 11:56:02 -0300
Subject: [PATCH 3/3] toolutil: Fix MASM generation for x86-64 and ARM64

---
 icu4c/source/tools/toolutil/pkg_genc.cpp | 12 ++++++++++++
 1 file changed, 12 insertions(+)

diff --git a/icu4c/source/tools/toolutil/pkg_genc.cpp b/icu4c/source/tools/toolutil/pkg_genc.cpp
index 4ae36702da6..af253e38cad 100644
--- a/icu4c/source/tools/toolutil/pkg_genc.cpp
+++ b/icu4c/source/tools/toolutil/pkg_genc.cpp
@@ -254,6 +254,17 @@ static const struct AssemblyType {
         "%s:\n",
         "  dd ","",HEX_0X
     },
+#if defined(_WIN64)
+    { "masm",
+      "\tTITLE %s\n"
+      "; generated by genccode\n"
+      "\tPUBLIC _%s\n"
+      "ICUDATA_%s\tSEGMENT READONLY 'DATA'\n"
+      "\tALIGN 16\n"
+      "_%s\tLABEL DWORD\n",
+      "\tDWORD ","\nICUDATA_%s\tENDS\n\tEND\n",HEX_0H
+    }
+#else
     { "masm",
       "\tTITLE %s\n"
       "; generated by genccode\n"
@@ -274,6 +285,7 @@ static const struct AssemblyType {
       "_%s\tLABEL DWORD\n",
       "\tDWORD ","\nICUDATA_%s\tENDS\n\tEND\n",HEX_0H
     }
+#endif
 };
 
 static int32_t assemblyHeaderIndex = -1;
-- 
2.24.1.windows.2

